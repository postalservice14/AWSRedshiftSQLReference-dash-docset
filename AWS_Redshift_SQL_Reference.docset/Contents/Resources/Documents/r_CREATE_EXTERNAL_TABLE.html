<!DOCTYPE html>
<html>
<head>
    <link href="css/awsdocs.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/awsdocs.min.js"></script>
    <meta charset="utf-8">
</head>
<body>
    <div id="content" style="padding: 10px 30px;">
    <div></div><h1 class="topictitle" id="r_CREATE_EXTERNAL_TABLE">CREATE EXTERNAL TABLE</h1><p>Creates a new external table in the specified schema. All external tables must be
                        created in an external schema. Search path is not supported for external schemas and
                        external tables. For more information, see <a href="r_CREATE_EXTERNAL_SCHEMA.html">CREATE EXTERNAL SCHEMA</a>.
                     </p><p>To create external tables, you must be the owner of the external schema or a superuser.
                        To transfer ownership of an external schema, use ALTER SCHEMA to change the owner.
                        Access
                        to external tables is controlled by access to the external schema. You can&apos;t <a href="r_GRANT.html">GRANT</a> or <a href="r_REVOKE.html">REVOKE</a> permissions on an external table. Instead, grant or revoke
                        USAGE on the external schema.
                     </p><p>In addition to external tables created using the CREATE EXTERNAL TABLE command, Amazon
                        Redshift can
                        reference external tables defined in an AWS Glue or Amazon Athena data catalog or
                        a Hive
                        metastore. Use the <a href="r_CREATE_EXTERNAL_SCHEMA.html">CREATE EXTERNAL SCHEMA</a> command to register an external database
                        defined in an AWS Glue or Athena data catalog or Hive metastore and make the external
                        tables
                        available for use in Amazon Redshift. If the external table exists in an AWS Glue
                        or Athena data catalog
                        or Hive metastore, you don&apos;t need to create the table using CREATE EXTERNAL TABLE.
                        To view
                        external tables, query the <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SVV_EXTERNAL_TABLES.html">SVV_EXTERNAL_TABLES</a> system view. 
                     </p><p>You can query an external table using the same SELECT syntax you use with other Amazon
                        Redshift
                        tables. External tables are read-only. You can&apos;t write to an external table.
                     </p><p>To create a view with an external table, include the WITH NO SCHEMA BINDING clause
                        in
                        the <a href="r_CREATE_VIEW.html">CREATE VIEW</a> statement.
                     </p><p>You can&apos;t execute CREATE EXTERNAL TABLE inside a transaction (BEGIN &#x2026; END).</p><h2 id="r_CREATE_EXTERNAL_TABLE-synopsis">Syntax</h2><pre class="screen">CREATE EXTERNAL TABLE
<em>external_schema.table_name</em>  
(<em>column_name</em> <em>data_type</em> [, &#x2026;] )
[ PARTITIONED BY (<em>col_name</em> <em>data_type</em> [, &#x2026; ] )] 
[ { ROW FORMAT DELIMITED <em>row_format</em> |
  ROW FORMAT SERDE &apos;<em>serde_name</em>&apos; 
  [ WITH SERDEPROPERTIES ( &apos;<em>property_name</em>&apos; = &apos;<em>property_value</em>&apos; [, ...] ) ] } ]
STORED AS <em>file_format</em>
LOCATION { &apos;s3://<em>bucket/folder</em>/&apos; | &apos;s3://<em>bucket/manifest_file</em>&apos; }
[ TABLE PROPERTIES ( &apos;<em>property_name</em>&apos;=&apos;<em>property_value</em>&apos; [, ...] ) ]</pre><h2 id="r_CREATE_EXTERNAL_TABLE-parameters">Parameters</h2><div class="variablelist">
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <dl>
                           
                           <dt><span class="term">
                                 <em>external_schema.table_name</em>
                                 </span></dt>
                           
                           <dd>
                              
                              <p>The name of the table to be created, qualified by an external schema name.
                                 External tables must be created in an external schema. For more information,
                                 see <a href="r_CREATE_EXTERNAL_SCHEMA.html">CREATE EXTERNAL SCHEMA</a>.
                              </p>
                              
                              <p>The maximum length for the table name is 127 bytes; longer names are
                                 truncated to 127 bytes. You can use UTF-8 multibyte characters up to a maximum
                                 of four bytes. Amazon Redshift enforces a limit of 9,900 tables per cluster, including
                                 user-defined temporary tables and temporary tables created by Amazon Redshift during
                                 query
                                 processing or system maintenance. Optionally, you can qualify the table name
                                 with the database name. In the following example, the database name is
                                 <code class="code">spectrum_db</code> , the external schema name is
                                 <code class="code">spectrum_schema</code>, and the table name is
                                 <code class="code">test</code>.
                              </p>
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">create external table spectrum_db.spectrum_schema.test (c1 int)
stored as textfile 
location &apos;s3://mybucket/myfolder/&apos;;</code></pre>
                              <p>If the database or schema specified doesn&apos;t exist, the table is not created,
                                 and the statement returns an error. You can&apos;t create tables or views in the
                                 system databases <code class="code">template0</code>, <code class="code">template1</code>, and
                                 <code class="code">padb_harvest</code>.
                              </p>
                              
                              <p>The table name must be a unique name for the specified schema. </p>
                              
                              <p>For more information about valid names, see <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_names.html">Names and Identifiers</a>.
                              </p>
                              
                           </dd>
                           
                           
                           <dt><span class="term">( <em>column_name</em>
                                 <em>data_type</em> )</span></dt>
                           
                           <dd>
                              
                              <p>The name and data type of each column being created.</p>
                              
                              <p>The maximum length for the column name is 127 bytes; longer names are
                                 truncated to 127 bytes. You can use UTF-8 multibyte characters up to a maximum
                                 of four bytes. You can&apos;t specify column names <code class="code">&quot;$path&quot;</code> or
                                 <code class="code">&quot;$size&quot;</code>. For more information about valid names, see <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_names.html">Names and Identifiers</a>.
                              </p>
                              
                              <p>By default, Amazon Redshift creates external tables with the pseudocolumns
                                 <code class="code">$path</code> and <code class="code">$size</code>. You can disable creation of
                                 pseudocolumns for a session by setting the
                                 <code class="code">spectrum_enable_pseudo_columns</code> configuration parameter to
                                 <code class="code">false</code>. For more information, see <a href="r_CREATE_EXTERNAL_TABLE.html#r_CREATE_EXTERNAL_TABLE_usage-pseudocolumns">Pseudocolumns </a>.
                              </p>
                              
                              <p>If pseudocolumns are enabled, the maximum number of columns you can define
                                 in a single table is 1,598. If pseudocolumns are not enabled, the maximum
                                 number of columns you can define in a single table is 1,600. 
                              </p>
                              
                              <div class="aws-note">
                                 <p class="aws-note">Note</p>
                                 <p>If you are creating a &quot;wide table,&quot; make sure that your list of columns
                                    doesn&apos;t exceed row-width boundaries for intermediate results during loads
                                    and query processing. For more information, see <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_TABLE_usage.html">Usage Notes</a>.
                                 </p>
                              </div>
                              
                           </dd>
                           
                           
                           <dt><span class="term">
                                 <em>data_type</em>
                                 </span></dt>
                           
                           <dd>
                              
                              <p>The following <a href="https://docs.aws.amazon.com/redshift/latest/dg/c_Supported_data_types.html">data types</a> are supported:
                              </p>
                              
                              <div class="itemizedlist">
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 <ul class="itemizedlist" type="disc">
                                    <li class="listitem">
                                       
                                       <p>SMALLINT (INT2)</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>INTEGER (INT, INT4)</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>BIGINT (INT8)</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>DECIMAL (NUMERIC)</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>REAL (FLOAT4)</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>DOUBLE PRECISION (FLOAT8)</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>BOOLEAN (BOOL)</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>CHAR (CHARACTER)</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>VARCHAR (CHARACTER VARYING)</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>DATE (DATE data type can be used only with text, Parquet, or ORC data
                                          files, or as a partition column)
                                       </p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>TIMESTAMP</p>
                                       
                                    </li>
                                 </ul>
                              </div>
                              
                              <p>Timestamp values in text files must be in the format <code class="code">yyyy-MM-dd
                                    HH:mm:ss.SSSSSS</code>, as the following timestamp value shows:
                                 <code class="code">2017-05-01 11:30:59.000000</code> .
                              </p>
                              
                              <p>The length of a VARCHAR column is defined in bytes, not characters. For
                                 example, a VARCHAR(12) column can contain 12 single-byte characters or 6
                                 two-byte characters. When you query an external table, results are truncated to
                                 fit the defined column size without returning an error. For more information,
                                 see <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_Character_types.html#r_Character_types-storage-and-ranges">Storage and
                                    Ranges</a>
                                 
                              </p>
                              
                              <p>For best performance, we recommend specifying the smallest column size that
                                 fits your data. To find the maximum size in bytes for values in a column, use
                                 the <a href="r_OCTET_LENGTH.html">OCTET_LENGTH</a> function. The
                                 following example returns the maximum size of values in the email
                                 column.
                              </p>
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">select max(octet_length(email)) from users;

max
---
 62</code></pre>
                              </dd>
                           
                           
                           
                           <dt><span class="term">PARTITIONED BY (<em>col_name</em>
                                 <em>data_type</em> [, &#x2026; ] )</span></dt>
                           
                           <dd>
                              
                              <p>A clause that defines a partitioned table with one or more partition
                                 columns. A separate data directory is used for each specified combination,
                                 which can improve query performance in some circumstances. Partitioned columns
                                 don&apos;t exist within the table data itself. If you use a value for
                                 <em>col_name</em> that is the same as a table column, you get an
                                 error. 
                              </p>
                              
                              <p>After creating a partitioned table, alter the table using an <a href="r_ALTER_TABLE.html">ALTER TABLE</a> &#x2026; ADD PARTITION
                                 statement to add partitions. When you add a partition, you define the location
                                 of the subfolder on Amazon S3 that contains the partition data. You can add only one
                                 partition in each ALTER TABLE statement.
                              </p>
                              
                              <p>For example, if the table <code class="code">spectrum.lineitem_part</code> is defined
                                 with <code class="code">PARTITIONED BY (l_shipdate date)</code>, execute the following ALTER
                                 TABLE command to add a partition.
                              </p>
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">ALTER TABLE spectrum.lineitem_part ADD PARTITION (l_shipdate=&apos;1992-01-29&apos;) 
LOCATION &apos;s3://spectrum-public/lineitem_partition/l_shipdate=1992-01-29&apos;;</code></pre>
                              <p>To view partitions, query the <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SVV_EXTERNAL_PARTITIONS.html">SVV_EXTERNAL_PARTITIONS</a> system view.
                              </p>
                              
                           </dd>
                           
                           
                           <dt><span class="term">ROW FORMAT DELIMITED <em>rowformat</em></span></dt>
                           
                           <dd>
                              
                              <p>A clause that specifies the format of the underlying data. Possible values
                                 for <em>rowformat</em> are as follows:
                              </p>
                              
                              <div class="itemizedlist">
                                 
                                 
                                 
                                 <ul class="itemizedlist" type="disc">
                                    <li class="listitem">
                                       
                                       <p>LINES TERMINATED BY &apos;<em>delimiter</em>&apos; 
                                       </p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>FIELDS TERMINATED BY &apos;<em>delimiter</em>&apos; 
                                       </p>
                                       
                                    </li>
                                 </ul>
                              </div>
                              
                              <p>Specify a single ASCII character for &apos;<em>delimiter</em>&apos;. You
                                 can specify non-printing ASCII characters using octal, in the format
                                 <code class="code">&apos;\</code><em><code class="code">ddd</code></em><code class="code">&apos;</code> where
                                 <em><code class="code">d</code></em> is an octal digit (0&#x2013;7) up to &#x2018;\177&#x2019;.
                                 The following example specifies the BEL (bell) character using octal. 
                              </p>
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">ROW FORMAT DELIMITED FIELDS TERMINATED BY &apos;\007&apos;</code></pre>
                              <p>If ROW FORMAT is omitted, the default format is DELIMITED FIELDS TERMINATED
                                 BY &apos;\A&apos; (start of heading) and LINES TERMINATED BY &apos;\n&apos; (newline). 
                              </p>
                              
                              
                           </dd>
                           
                           
                           <dt><span class="term">ROW FORMAT SERDE &apos;<em>serde_name</em>&apos; </span></dt>
                           
                           <dt><span class="term">[WITH SERDEPROPERTIES ( &apos;<em>property_name</em>&apos; =
                                 &apos;<em>property_value</em>&apos; [, ...] ) ]</span></dt>
                           
                           <dd>
                              
                              <p>A clause that specifies the SERDE format for the underlying data. </p>
                              
                              <div class="variablelist">
                                 
                                 
                                 <dl>
                                    
                                    <dt><span class="term">&apos;<em>serde_name</em>&apos;</span></dt>
                                    
                                    <dd>
                                       
                                       <p>The name of the SerDe. The following are supported:</p>
                                       
                                       <div class="itemizedlist">
                                          
                                          
                                          
                                          
                                          
                                          <ul class="itemizedlist" type="disc">
                                             <li class="listitem">
                                                
                                                <p>org.apache.hadoop.hive.serde2.RegexSerDe </p>
                                                
                                             </li>
                                             <li class="listitem">
                                                
                                                <p>com.amazonaws.glue.serde.GrokSerDe </p>
                                                
                                             </li>
                                             <li class="listitem">
                                                
                                                <p>org.apache.hadoop.hive.serde2.OpenCSVSerde </p>
                                                
                                             </li>
                                             <li class="listitem">
                                                
                                                <p>org.openx.data.jsonserde.JsonSerDe</p>
                                                
                                                <div class="itemizedlist">
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   <ul class="itemizedlist" type="disc">
                                                      <li class="listitem">
                                                         
                                                         <p>The JSON SERDE also supports Ion files. </p>
                                                         
                                                      </li>
                                                      <li class="listitem">
                                                         
                                                         <p>The JSON must be well-formed. </p>
                                                         
                                                      </li>
                                                      <li class="listitem">
                                                         
                                                         <p>Timestamps in Ion and JSON must use ISO8601
                                                            format.
                                                         </p>
                                                         
                                                      </li>
                                                      <li class="listitem">
                                                         
                                                         <p>The following SerDe property is supported for the
                                                            JsonSerDe: 
                                                         </p>
                                                         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">&apos;strip.outer.array&apos;=&apos;true&apos; </code></pre>
                                                         <p>Processes Ion/JSON files containing one very large
                                                            array enclosed in outer brackets ( [ &#x2026; ] ) as if it
                                                            contains multiple JSON records within the array. 
                                                         </p>
                                                         
                                                      </li>
                                                   </ul>
                                                </div>
                                                
                                             </li>
                                          </ul>
                                       </div>
                                       
                                    </dd>
                                    
                                 </dl>
                              </div>
                              
                              <div class="variablelist">
                                 
                                 
                                 <dl>
                                    
                                    <dt><span class="term">WITH SERDEPROPERTIES ( &apos;<em>property_name</em>&apos; =
                                          &apos;<em>property_value</em>&apos; [, ...] ) ]</span></dt>
                                    
                                    <dd>
                                       
                                       <p>Optionally, specify property names and values, separated by
                                          commas.
                                       </p>
                                       
                                    </dd>
                                    
                                 </dl>
                              </div>
                              
                              <p>If ROW FORMAT is omitted, the default format is DELIMITED FIELDS TERMINATED
                                 BY &apos;\A&apos; (start of heading) and LINES TERMINATED BY &apos;\n&apos; (newline). 
                              </p>
                              
                              
                           </dd>
                           
                           
                           <dt><span class="term">STORED AS <em>file_format</em></span></dt>
                           
                           <dd>
                              
                              <p>The file format for data files. </p>
                              
                              <p>Valid formats are as follows:</p>
                              
                              <div class="itemizedlist">
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 <ul class="itemizedlist" type="disc">
                                    <li class="listitem">
                                       
                                       <p>PARQUET</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>RCFILE (for data using ColumnarSerDe only, not
                                          LazyBinaryColumnarSerDe)
                                       </p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>SEQUENCEFILE</p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>TEXTFILE </p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>ORC </p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>AVRO </p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p>INPUTFORMAT &apos;<em>input_format_classname</em>&apos; OUTPUTFORMAT
                                          &apos;<em>output_format_classname</em>&apos; 
                                       </p>
                                       
                                    </li>
                                 </ul>
                              </div>
                              
                              <p>For INPUTFORMAT and OUTPUTFORMAT, specify a class name, as the following
                                 example shows: 
                              </p>
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">&apos;org.apache.hadoop.mapred.TextInputFormat&apos;</code></pre>
                              </dd>
                           
                           
                           <dt><a id="create-external-table-location"></a><span class="term">LOCATION { &apos;s3://<em>bucket/folder</em>/&apos; |
                                 &apos;s3://<em>bucket/manifest_file</em>&apos;</span></dt>
                           
                           <dd>
                              
                              
                              <p>The path to the Amazon S3 bucket or folder that contains the data files or a
                                 manifest file that contains a list of Amazon S3 object paths. The buckets must
                                 be in the same AWS Region as the Amazon Redshift cluster. For a list of
                                 supported AWS Regions, see <a href="https://docs.aws.amazon.com/redshift/latest/dg/c-using-spectrum.html#c-spectrum-considerations">Amazon Redshift Spectrum Considerations</a>.
                              </p>
                              
                              
                              
                              <p>If the path specifies a bucket or folder, for example,
                                 <code class="code">&apos;s3://mybucket/custdata/&apos;</code>, Redshift Spectrum scans the files in
                                 the specified bucket or folder and any subfolders. Redshift Spectrum ignores
                                 hidden files and files that begin with a period or underscore. 
                              </p>
                              
                              <p>If the path specifies a manifest file, the
                                 <code class="code">&apos;s3://bucket/manifest_file&apos;</code> argument must explicitly reference
                                 a single file&#x2014;for example,<code class="code">&apos;s3://mybucket/manifest.txt&apos;</code>. It
                                 can&apos;t reference a key prefix. 
                              </p>
                              
                              <p>The manifest is a text file in JSON format that lists the URL of each file
                                 that is to be loaded from Amazon S3 and the size of the file, in bytes. The URL
                                 includes the bucket name and full object path for the file. The files that are
                                 specified in the manifest can be in different buckets, but all the buckets must
                                 be in the same AWS Region as the Amazon Redshift cluster. If a file is listed
                                 twice, the file is loaded twice. The following example shows the JSON for a
                                 manifest that loads three files. 
                              </p>
                              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">{
  &quot;entries&quot;: [
    {&quot;url&quot;:&quot;s3://mybucket-alpha/custdata.1&quot;, &quot;meta&quot;: { &quot;content_length&quot;: 5956875 } },
    {&quot;url&quot;:&quot;s3://mybucket-alpha/custdata.2&quot;, &quot;meta&quot;: { &quot;content_length&quot;: 5997091 } },
    {&quot;url&quot;:&quot;s3://mybucket-beta/custdata.1&quot;, &quot;meta&quot;: { &quot;content_length&quot;: 5978675 } }
  ]
}</code></pre>
                              <p>To reference files created using UNLOAD, you can use the manifest created
                                 using <a href="r_UNLOAD.html">UNLOAD</a> with the MANIFEST
                                 parameter. The manifest file is compatible with a manifest file for <a href="https://docs.aws.amazon.com/redshift/latest/dg/copy-parameters-data-source-s3.html">COPY from Amazon S3</a>, but uses different keys.
                                 Keys that aren&apos;t used are ignored. 
                              </p>
                              
                           </dd>
                           
                           
                           <dt><span class="term">TABLE PROPERTIES (
                                 &apos;<em>property_name</em>&apos;=&apos;<em>property_value</em>&apos; [,
                                 ...] ) </span></dt>
                           
                           <dd>
                              
                              <p>A clause that sets the table definition for table properties. </p>
                              
                              <div class="aws-note">
                                 <p class="aws-note">Note</p>
                                 <p>Table properties are case-sensitive.</p>
                              </div>
                              
                              <div class="variablelist">
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 <dl>
                                    
                                    <dt><span class="term"> &apos;compression_type&apos;=&apos;<em>value</em>&apos; </span></dt>
                                    
                                    <dd>
                                       
                                       <p> A property that sets the type of compression to use if the file
                                          name does not contain an extension. If you set this property and there
                                          is a file extension, the extension is ignored and the value set by the
                                          property is used. Valid values for compression type are as
                                          follows:
                                       </p>
                                       
                                       <div class="itemizedlist">
                                          
                                          
                                          
                                          
                                          
                                          
                                          <ul class="itemizedlist" type="disc">
                                             <li class="listitem">
                                                
                                                <p>bzip2</p>
                                                
                                             </li>
                                             <li class="listitem">
                                                
                                                <p>gzip</p>
                                                
                                             </li>
                                             <li class="listitem">
                                                
                                                <p>none</p>
                                                
                                             </li>
                                             <li class="listitem">
                                                
                                                <p>snappy</p>
                                                
                                             </li>
                                          </ul>
                                       </div>
                                       
                                       
                                    </dd>
                                    
                                    
                                    
                                    <dt><span class="term">&apos;numRows&apos;=&apos;<em>row_count</em>&apos; </span></dt>
                                    
                                    <dd>
                                       
                                       <p>A property that sets the numRows value for the table definition. To
                                          explicitly update an external table&apos;s statistics, set the numRows
                                          property to indicate the size of the table. Amazon Redshift doesn&apos;t analyze
                                          external tables to generate the table statistics that the query
                                          optimizer uses to generate a query plan. If table statistics are not
                                          set for an external table, Amazon Redshift generates a query execution plan based
                                          on an assumption that external tables are the larger tables and local
                                          tables are the smaller tables.
                                       </p>
                                       
                                    </dd>
                                    
                                    
                                    <dt><span class="term">&apos;skip.header.line.count&apos;=&apos;<em>line_count</em>&apos;</span></dt>
                                    
                                    <dd>
                                       
                                       <p>A property that sets number of rows to skip at the beginning of
                                          each source file.
                                       </p>
                                       
                                    </dd>
                                    
                                    
                                    <dt><span class="term">&apos;serialization.null.format&apos;=&apos; &apos;</span></dt>
                                    
                                    <dd>
                                       
                                       
                                       <p>A property that specifies Spectrum should return a
                                          <code class="code">NULL</code> value when there is an exact match with the text
                                          supplied in a field.
                                       </p>
                                       
                                    </dd>
                                    
                                    
                                    <dt><span class="term">&apos;orc.schema.resolution&apos;=&apos;mapping_type&apos;</span></dt>
                                    
                                    <dd>
                                       
                                       <p>A property that sets the column mapping type for tables that use
                                          ORC data format. This property is ignored for other data
                                          formats.
                                       </p>
                                       
                                       <p>Valid values for column mapping type are as follows: </p>
                                       
                                       <div class="itemizedlist">
                                          
                                          
                                          
                                          <ul class="itemizedlist" type="disc">
                                             <li class="listitem">
                                                
                                                <p>name </p>
                                                
                                             </li>
                                             <li class="listitem">
                                                
                                                <p>position </p>
                                                
                                             </li>
                                          </ul>
                                       </div>
                                       
                                       <p>If the <em>orc.schema.resolution</em> property is
                                          omitted, columns are mapped by name by default. If
                                          <em>orc.schema.resolution</em> is set to any value
                                          other than <em>&apos;name&apos;</em> or
                                          <em>&apos;position&apos;</em>, columns are mapped by position.
                                          For more information about column mapping, see <a href="https://docs.aws.amazon.com/redshift/latest/dg/c-spectrum-external-tables.html#c-spectrum-column-mapping-orc">Mapping External Table Columns to ORC
                                             Columns</a></p>
                                       
                                       <div class="aws-note">
                                          <p class="aws-note">Note</p>
                                          <p>The COPY command maps to ORC data files only by position. The
                                             <em>orc.schema.resolution</em> table property has no
                                             effect on COPY command behavior. 
                                          </p>
                                       </div>
                                       
                                    </dd>
                                    
                                 </dl>
                              </div>
                              
                           </dd>
                           
                        </dl>
                     </div><h2 id="r_CREATE_EXTERNAL_TABLE_usage">Usage Notes</h2><p>You can&apos;t view details for Amazon Redshift Spectrum tables using the same resources
                        you use for
                        standard Amazon Redshift tables, such as <a href="r_PG_TABLE_DEF.html">PG_TABLE_DEF</a>, <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_STV_TBL_PERM.html">STV_TBL_PERM</a>, PG_CLASS, or information_schema. If your business
                        intelligence or analytics tool doesn&apos;t recognize Redshift Spectrum external tables,
                        configure your application to query <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SVV_EXTERNAL_TABLES.html">SVV_EXTERNAL_TABLES</a> and <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SVV_EXTERNAL_COLUMNS.html">SVV_EXTERNAL_COLUMNS</a>.
                     </p><h3 id="r_CREATE_EXTERNAL_TABLE_usage-permissions">Permissions to Create and
                        Query External Tables 
                     </h3><p>To create external tables, you must be the owner of the external schema or a
                        superuser. To transfer ownership of an external schema, use <a href="r_ALTER_SCHEMA.html">ALTER SCHEMA</a>. The following example
                        changes the owner of the <code class="code">spectrum_schema</code> schema to
                        <code class="code">newowner</code>.
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">alter schema spectrum_schema owner to newowner;</code></pre><p>To run a Redshift Spectrum query, you need the following permissions:</p><div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>Usage permission on the schema </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Permission to create temporary tables in the current database </p>
                              
                           </li>
                        </ul>
                     </div><p>The following example grants usage permission on the schema
                        <code class="code">spectrum_schema</code> to the <code class="code">spectrumusers</code> user group.
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">grant usage on schema spectrum_schema to group spectrumusers;</code></pre><p>The following example grants temporary permission on the database
                        <code class="code">spectrumdb</code> to the <code class="code">spectrumusers</code> user group. 
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">grant temp on database spectrumdb to group spectrumusers;</code></pre><h3 id="r_CREATE_EXTERNAL_TABLE_usage-pseudocolumns">Pseudocolumns </h3><p>By default, Amazon Redshift creates external tables with the pseudocolumns
                        <em>$path</em> and <em>$size</em>. Select these columns to
                        view the path to the data files on Amazon S3 and the size of the data files for each
                        row returned by a query. The <em>$path</em> and
                        <em>$size</em> column names must be delimited with double quotation
                        marks. A <em>SELECT *</em> clause doesn&apos;t return the pseudocolumns . You
                        must explicitly include the <em>$path</em> and <em>$size</em>
                        column names in your query, as the following example shows.
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">select &quot;$path&quot;, &quot;$size&quot;
from spectrum.sales_part
where saledate = &apos;2008-12-01&apos;;</code></pre><p>You can disable creation of pseudocolumns for a session by setting the
                        <em>spectrum_enable_pseudo_columns</em> configuration parameter to
                        <em>false</em>. 
                     </p><div class="aws-note">
                        <p class="aws-note">Important</p>
                        <p>Selecting <em>$size</em> or <em>$path</em> incurs
                           charges because Redshift Spectrum scans the data files on Amazon S3 to determine
                           the size of the result set. For more information, see <a href="https://aws.amazon.com/redshift/pricing/" target="_blank">Amazon Redshift Pricing</a>.
                        </p>
                     </div><h2 id="r_CREATE_EXTERNAL_TABLE_examples">Examples</h2><p>The following example creates a table named SALES in the Amazon Redshift external
                        schema named
                        <code class="code">spectrum</code>. The data is in tab-delimited text files. The TABLE PROPERTIES
                        clause sets the numRows property to 170,000 rows.
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">create external table spectrum.sales(
salesid integer,
listid integer,
sellerid integer,
buyerid integer,
eventid integer,
saledate date,
qtysold smallint,
pricepaid decimal(8,2),
commission decimal(8,2),
saletime timestamp)
row format delimited
fields terminated by &apos;\t&apos;
stored as textfile
location &apos;s3://awssampledbuswest2/tickit/spectrum/sales/&apos;
table properties (&apos;numRows&apos;=&apos;170000&apos;);</code></pre><p>The following example creates a table that uses the JsonSerDe to reference data in
                        JSON format.
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">create external table spectrum.cloudtrail_json (
event_version int
event_id bigint,
event_time timestamp,
event_type varchar(10),
awsregion varchar(20),
event_name varchar(max),
event_source varchar(max),
requesttime timestamp,
useragent varchar(max),
recipientaccountid bigint) 
row format serde &apos;org.openx.data.jsonserde.JsonSerDe&apos;
with serdeproperties (
&apos;dots.in.keys&apos; = &apos;true&apos;,
&apos;mapping.requesttime&apos; = &apos;requesttimestamp&apos;
) location &apos;s3://mybucket/json/cloudtrail&apos;;</code></pre><p>For a list of existing databases in the external data catalog, query the <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SVV_EXTERNAL_DATABASES.html">SVV_EXTERNAL_DATABASES</a> system
                        view. 
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">select eskind,databasename,esoptions from svv_external_databases order by databasename;</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">eskind | databasename | esoptions                                                                        
-------+--------------+----------------------------------------------------------------------------------
     1 | default      | {&quot;REGION&quot;:&quot;us-west-2&quot;,&quot;IAM_ROLE&quot;:&quot;arn:aws:iam::123456789012:role/mySpectrumRole&quot;}
     1 | sampledb     | {&quot;REGION&quot;:&quot;us-west-2&quot;,&quot;IAM_ROLE&quot;:&quot;arn:aws:iam::123456789012:role/mySpectrumRole&quot;}
     1 | spectrumdb   | {&quot;REGION&quot;:&quot;us-west-2&quot;,&quot;IAM_ROLE&quot;:&quot;arn:aws:iam::123456789012:role/mySpectrumRole&quot;}
</code></pre><p>To view details of external tables, query the <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SVV_EXTERNAL_TABLES.html">SVV_EXTERNAL_TABLES</a> and <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SVV_EXTERNAL_COLUMNS.html">SVV_EXTERNAL_COLUMNS</a> system views.
                     </p><p>The following example queries the SVV_EXTERNAL_TABLES view.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">select schemaname, tablename, location from svv_external_tables;</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">schemaname | tablename            | location                                               
-----------+----------------------+--------------------------------------------------------
spectrum   | sales                | s3://awssampledbuswest2/tickit/spectrum/sales          
spectrum   | sales_part           | s3://awssampledbuswest2/tickit/spectrum/sales_partition</code></pre><p>The following example queries the SVV_EXTERNAL_COLUMNS view. </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">select * from svv_external_columns where schemaname like &apos;spectrum%&apos; and tablename =&apos;sales&apos;;</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">schemaname | tablename | columnname | external_type | columnnum | part_key
-----------+-----------+------------+---------------+-----------+---------
spectrum   | sales     | salesid    | int           |         1 |        0
spectrum   | sales     | listid     | int           |         2 |        0
spectrum   | sales     | sellerid   | int           |         3 |        0
spectrum   | sales     | buyerid    | int           |         4 |        0
spectrum   | sales     | eventid    | int           |         5 |        0
spectrum   | sales     | saledate   | date          |         6 |        0
spectrum   | sales     | qtysold    | smallint      |         7 |        0
spectrum   | sales     | pricepaid  | decimal(8,2)  |         8 |        0
spectrum   | sales     | commission | decimal(8,2)  |         9 |        0
spectrum   | sales     | saletime   | timestamp     |        10 |        0</code></pre><p>To view table partitions, use the following query.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">select schemaname, tablename, values, location 
from svv_external_partitions
where tablename = &apos;sales_part&apos;;</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">schemaname | tablename  | values         | location                                                                
-----------+------------+----------------+-------------------------------------------------------------------------
spectrum   | sales_part | [&quot;2008-01-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-01
spectrum   | sales_part | [&quot;2008-02-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-02
spectrum   | sales_part | [&quot;2008-03-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-03
spectrum   | sales_part | [&quot;2008-04-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-04
spectrum   | sales_part | [&quot;2008-05-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-05
spectrum   | sales_part | [&quot;2008-06-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-06
spectrum   | sales_part | [&quot;2008-07-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-07
spectrum   | sales_part | [&quot;2008-08-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-08
spectrum   | sales_part | [&quot;2008-09-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-09
spectrum   | sales_part | [&quot;2008-10-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-10
spectrum   | sales_part | [&quot;2008-11-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-11
spectrum   | sales_part | [&quot;2008-12-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-12</code></pre><p>The following example returns the total size of related data files for an external
                        table.
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">select distinct &quot;$path&quot;, &quot;$size&quot;
   from spectrum.sales_part;

 $path                                 | $size
---------------------------------------+-------
s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-01/ |  1616
s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-02/ |  1444
s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-02/ |  1444
</code></pre><h2 id="r_CREATE_EXTERNAL_TABLE_examples-partitioning">Partitioning
                        Examples
                     </h2><p>To create an external table partitioned by date, run the following command.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">create external table spectrum.sales_part(
salesid integer,
listid integer,
sellerid integer,
buyerid integer,
eventid integer,
dateid smallint,
qtysold smallint,
pricepaid decimal(8,2),
commission decimal(8,2),
saletime timestamp)
partitioned by (saledate date)
row format delimited
fields terminated by &apos;|&apos;
stored as textfile
location &apos;s3://awssampledbuswest2/tickit/spectrum/sales_partition/&apos;
table properties (&apos;numRows&apos;=&apos;170000&apos;);</code></pre><p>To add the partitions, run the following ALTER TABLE commands.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">alter table spectrum.sales_part
add if not exists partition (saledate=&apos;2008-01-01&apos;) 
location &apos;s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-01/&apos;;
alter table spectrum.sales_part
add if not exists partition (saledate=&apos;2008-02-01&apos;) 
location &apos;s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-02/&apos;;
alter table spectrum.sales_part
add if not exists partition (saledate=&apos;2008-03-01&apos;) 
location &apos;s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-03/&apos;;
alter table spectrum.sales_part
add if not exists partition (saledate=&apos;2008-04-01&apos;) 
location &apos;s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-04/&apos;;
alter table spectrum.sales_part
add if not exists partition (saledate=&apos;2008-05-01&apos;) 
location &apos;s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-05/&apos;;
alter table spectrum.sales_part
add if not exists partition (saledate=&apos;2008-06-01&apos;) 
location &apos;s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-06/&apos;;
alter table spectrum.sales_part
add if not exists partition (saledate=&apos;2008-07-01&apos;) 
location &apos;s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-07/&apos;;
alter table spectrum.sales_part
add if not exists partition (saledate=&apos;2008-08-01&apos;) 
location &apos;s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-08/&apos;;
alter table spectrum.sales_part
add if not exists partition (saledate=&apos;2008-09-01&apos;) 
location &apos;s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-09/&apos;;
alter table spectrum.sales_part
add if not exists partition (saledate=&apos;2008-10-01&apos;) 
location &apos;s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-10/&apos;;
alter table spectrum.sales_part
add if not exists partition (saledate=&apos;2008-11-01&apos;) 
location &apos;s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-11/&apos;;
alter table spectrum.sales_part
add if not exists partition (saledate=&apos;2008-12-01&apos;) 
location &apos;s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-12/&apos;;</code></pre><p>To select data from the partitioned table, run the following query.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">select top 10 spectrum.sales_part.eventid, sum(spectrum.sales_part.pricepaid) 
from spectrum.sales_part, event
where spectrum.sales_part.eventid = event.eventid
  and spectrum.sales_part.pricepaid &gt; 30
  and saledate = &apos;2008-12-01&apos;
group by spectrum.sales_part.eventid
order by 2 desc;</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">eventid | sum     
--------+---------
    914 | 36173.00
   5478 | 27303.00
   5061 | 26383.00
   4406 | 26252.00
   5324 | 24015.00
   1829 | 23911.00
   3601 | 23616.00
   3665 | 23214.00
   6069 | 22869.00
   5638 | 22551.00</code></pre><p>To view external table partitions, query the <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SVV_EXTERNAL_PARTITIONS.html">SVV_EXTERNAL_PARTITIONS</a>
                        system view.
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">select schemaname, tablename, values, location from svv_external_partitions
where tablename = &apos;sales_part&apos;;</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">schemaname | tablename  | values         | location                                         
-----------+------------+----------------+--------------------------------------------------
spectrum   | sales_part | [&quot;2008-01-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-01
spectrum   | sales_part | [&quot;2008-02-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-02
spectrum   | sales_part | [&quot;2008-03-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-03
spectrum   | sales_part | [&quot;2008-04-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-04
spectrum   | sales_part | [&quot;2008-05-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-05
spectrum   | sales_part | [&quot;2008-06-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-06
spectrum   | sales_part | [&quot;2008-07-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-07
spectrum   | sales_part | [&quot;2008-08-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-08
spectrum   | sales_part | [&quot;2008-09-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-09
spectrum   | sales_part | [&quot;2008-10-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-10
spectrum   | sales_part | [&quot;2008-11-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-11
spectrum   | sales_part | [&quot;2008-12-01&quot;] | s3://awssampledbuswest2/tickit/spectrum/sales_partition/saledate=2008-12</code></pre><h2 id="r_CREATE_EXTERNAL_TABLE_examples-row-format">Row Format
                        Examples
                     </h2><p>The following shows an example of specifying the ROW FORMAT SERDE parameters for data
                        files stored in AVRO format.
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">create external table spectrum.sales(salesid int, listid int, sellerid int, buyerid int, eventid int, dateid int, qtysold int, pricepaid decimal(8,2), comment VARCHAR(255))
ROW FORMAT SERDE &apos;org.apache.hadoop.hive.serde2.avro.AvroSerDe&apos;
WITH SERDEPROPERTIES (&apos;avro.schema.literal&apos;=&apos;{\&quot;namespace\&quot;: \&quot;dory.sample\&quot;,\&quot;name\&quot;: \&quot;dory_avro\&quot;,\&quot;type\&quot;: \&quot;record\&quot;, \&quot;fields\&quot;: [{\&quot;name\&quot;:\&quot;salesid\&quot;, \&quot;type\&quot;:\&quot;int\&quot;}, 
{\&quot;name\&quot;:\&quot;listid\&quot;, \&quot;type\&quot;:\&quot;int\&quot;}, 
{\&quot;name\&quot;:\&quot;sellerid\&quot;, \&quot;type\&quot;:\&quot;int\&quot;}, 
{\&quot;name\&quot;:\&quot;buyerid\&quot;, \&quot;type\&quot;:\&quot;int\&quot;}, 
{\&quot;name\&quot;:\&quot;eventid\&quot;,\&quot;type\&quot;:\&quot;int\&quot;}, 
{\&quot;name\&quot;:\&quot;dateid\&quot;,\&quot;type\&quot;:\&quot;int\&quot;}, 
{\&quot;name\&quot;:\&quot;qtysold\&quot;,\&quot;type\&quot;:\&quot;int\&quot;}, 
{\&quot;name\&quot;:\&quot;pricepaid\&quot;, \&quot;type\&quot;: {\&quot;type\&quot;: \&quot;bytes\&quot;, \&quot;logicalType\&quot;: \&quot;decimal\&quot;, \&quot;precision\&quot;: 8, \&quot;scale\&quot;: 2}}, {\&quot;name\&quot;:\&quot;comment\&quot;,\&quot;type\&quot;:\&quot;string\&quot;}]}&apos;)
STORED AS AVRO
location &apos;s3://mybucket/avro/sales&apos; ;</code></pre><p>The following shows an example of specifying the ROW FORMAT SERDE parameters using
                        RegEx.
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">create external table spectrum.types(
cbigint bigint,
cbigint_null bigint,
cint int,
cint_null int)
row format serde &apos;org.apache.hadoop.hive.serde2.RegexSerDe&apos;
with serdeproperties (&apos;input.regex&apos;=&apos;([^\\x01]+)\\x01([^\\x01]+)\\x01([^\\x01]+)\\x01([^\\x01]+)&apos;)
stored as textfile
location &apos;s3://mybucket/regex/types&apos;;</code></pre><p>The following shows an example of specifying the ROW FORMAT SERDE parameters using
                        Grok.
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">create external table spectrum.grok_log(
timestamp varchar(255),
pid varchar(255),
loglevel varchar(255),
progname varchar(255),
message varchar(255))
row format serde &apos;com.amazonaws.glue.serde.GrokSerDe&apos;
with serdeproperties (&apos;input.format&apos;=&apos;[DFEWI], \\[%{TIMESTAMP_ISO8601:timestamp} #%{POSINT:pid:int}\\] *(?&lt;loglevel&gt;:DEBUG|FATAL|ERROR|WARN|INFO) -- +%{DATA:progname}: %{GREEDYDATA:message}&apos;)
stored as textfile
location &apos;s3://mybucket/grok/logs&apos;;</code></pre><p>The following shows an example of defining an Amazon S3 server access log in an S3
                        bucket. You can use Redshift Spectrum to query Amazon S3 access logs.
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="sql ">CREATE EXTERNAL TABLE IF NOT EXISTS spectrum.mybucket_s3_logs(
bucketowner varchar(255),
bucket varchar(255),
requestdatetime varchar(2000),
remoteip varchar(255),
requester varchar(255),
requested varchar(255),
operation varchar(255),
key varchar(255),
requesturi_operation varchar(255),
requesturi_key varchar(255),
requesturi_httpprotoversion varchar(255),
httpstatus varchar(255),
errorcode varchar(255),
bytessent bigint,
objectsize bigint,
totaltime varchar(255),
turnaroundtime varchar(255),
referrer varchar(255),
useragent varchar(255),
versionid varchar(255)
)
ROW FORMAT SERDE &apos;org.apache.hadoop.hive.serde2.RegexSerDe&apos;
WITH SERDEPROPERTIES (
&apos;input.regex&apos; = &apos;([^ ]*) ([^ ]*) \\[(.*?)\\] ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) \&quot;([^ ]*)\\s*([^ ]*)\\s*([^ ]*)\&quot; (- |[^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) (\&quot;[^\&quot;]*\&quot;) ([^ ]*).*$&apos;)
LOCATION &apos;s3://mybucket/s3logs&#x2019;;            
</code></pre><div id="marketing-target"><span class="close-button"></span><div class="marketing-title" id="marketing-title"></div>
                        <div class="marketing-description"><span id="marketing-description"></span><span id="marketing-cta"></span></div>
                     </div></div>
</body>
</html>